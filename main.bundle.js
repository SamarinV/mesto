(()=>{"use strict";const e=class{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClassActive=e.errorClassActive,this._form=t,this._inputList=e.inputList,this._submitButton=e.submitButton}_isValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClassActive),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);t.classList.remove(this._errorClassActive),t.textContent="",e.classList.remove(this._inputErrorClass)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.setAttribute("disabled","true")):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.removeAttribute("disabled"))}_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e),e.addEventListener("input",(()=>{this._isValid(e),this._toggleButtonState()}))}))}_getForm(){return document.querySelector(this._form)}enableValidation(){return this._formElement=this._getForm(),this._setEventListeners(),this._formElement}clearError(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}},t={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClassActive:"popup__input-error_active"},s=class{constructor(e){this._popup=e,this._buttonClose=this._popup.querySelector(".popup__close")}openPopup(){this._popup.classList.add("popup_open"),this._setEventListener()}closePopup(){this._popup.classList.remove("popup_open")}_closePopupKeyEsc=()=>{i(),document.removeEventListener("keydown",this._closePopupKeyEsc)};_setEventListener(){this._popup.addEventListener("click",(e=>{e.target.closest(".popup__container")&&e.target!==this._buttonClose||this.closePopup()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.closePopup()}))}};function i(e){e.classList.remove("popup_open"),document.removeEventListener("keydown",o)}function o(e){"Escape"===e.key&&i(document.querySelector(".popup_open"))}const r=class extends s{constructor(e,t,s){super(e),this._name=t,this._link=s,this._image=document.querySelector(".popup__image"),this._title=document.querySelector(".popup__image-description")}openPopup(){this._image.setAttribute("src",`${this._link}`),this._image.setAttribute("alt",this._name),this._title.textContent=this._name,super.openPopup()}},n=document.querySelector(".places"),p=class{constructor(e,t,s,i,o){this._popup=o,this._name=s,this._link=i,this._template=t,this._cardClass=e.cardClass,this._likeClass=e.likeClass,this._toggleLike=e.toggleLike,this._buttonDeleteClass=e.buttonDeleteClass,this._imageClass=e.imageClass,this._imageTitleClass=e.imageTitleClass}_getTemplate=()=>document.querySelector(this._template).content.querySelector(this._cardClass).cloneNode(!0);_handleDeleteCard=()=>{this._element.remove(),this._element=null};_handleToggleLike=()=>{this._element.querySelector(this._likeClass).classList.toggle(this._toggleLike)};_setEventListeners(){this._element.querySelector(this._buttonDeleteClass).addEventListener("click",this._handleDeleteCard),this._element.querySelector(this._likeClass).addEventListener("click",this._handleToggleLike),this._element.querySelector(this._imageClass).addEventListener("click",(()=>{new r(this._popup,this._name,this._link).openPopup()}))}_generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(this._imageClass).setAttribute("src",`${this._link}`),this._element.querySelector(this._imageClass).setAttribute("alt",this._name),this._element.querySelector(this._imageTitleClass).textContent=this._name,this._element}rendererCard(){this._generateCard(),n.prepend(this._element)}},l={cardClass:".places__item",likeClass:".places__like",toggleLike:"places__like_active",buttonDeleteClass:".places__delete",imageClass:".places__image",imageTitleClass:".places__title",popupImageLookPlace:".popup__image",popupImageTitleLookPlace:".popup__image-description"},a=document.querySelector(".popup_edit"),u=document.querySelector(".profile__button-edit"),_=document.querySelector(".popup_add-place"),c=document.querySelector(".profile__button-add"),h=document.querySelector(".popup_position_look-place"),m=new class extends s{constructor(e){super(e),this._form=this._popup.querySelector(".popup__form_edit"),this._profileName=document.querySelector(".profile__name"),this._profileAboutSelf=document.querySelector(".profile__about-self"),this._inputNewName=this._form.querySelector(".popup__input_profile-name"),this._inputAboutSelf=this._form.querySelector(".popup__input_about-self")}closePopup(){super.closePopup(),this._inputNewName.value=this._profileName.textContent,this._inputAboutSelf.value=this._profileAboutSelf.textContent}_setEventListener(){super._setEventListener(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._profileName.textContent=this._inputNewName.value,this._profileAboutSelf.textContent=this._inputAboutSelf.value,this.closePopup()}))}}(a),d=new class extends s{constructor(e,t,s){super(e),this._form=this._popup.querySelector(".popup__form_add-place"),this._cardSetting=t,this._popupLookPlace=s,this._inputNamePlace=document.querySelector(".popup__input_name-place"),this._inputImageUrl=document.querySelector(".popup__input_url-image")}closePopup(){super.closePopup(),this._inputNamePlace.value="",this._inputImageUrl.value=""}_submitButton=e=>{e.preventDefault(),this._newCard=new p(this._cardSetting,".places__template",this._inputNamePlace.value,this._inputImageUrl.value,this._popupLookPlace),this._newCard.rendererCard(),this.closePopup()};_setEventListener=()=>{super._setEventListener(),this._form.addEventListener("submit",this._submitButton)}}(_,l,h),v=new e(t,".popup_add-place");v.enableValidation();const g=new e(t,".popup_edit");g.enableValidation(),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((e=>{new p(l,".places__template",e.name,e.link,h).rendererCard()})),u.addEventListener("click",(()=>{g.clearError(),m.openPopup()})),c.addEventListener("click",(()=>{v.clearError(),d.openPopup()}))})();